"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();angular.module("thatisuday.ng-full-modal",["ngAnimate","angular-click-outside"]),angular.module("thatisuday.ng-full-modal").provider("_nfm",function(){var e={closeDelay:0,templateHost:null,transitionDuration:"0.3s",escClose:!0,bgClose:!0,modalWidth:"700px",backdrop:"rgba(0,0,0,0.9)"};return{set:function(t){angular.extend(e,t)},$get:function(){return e}}}),angular.module("thatisuday.ng-full-modal").factory("nfm",["_nfm","$rootScope","$animate","$document","$compile","$controller","$http","$q","$templateRequest","$timeout","$sce",function(e,t,n,o,i,s,r,l,a,c,f){var h={enter:13,esc:27,left:37,right:39},u=function(){function r(t){_classCallCheck(this,r),this.conf=angular.extend(e,t),this._stateOpen=!1}return _createClass(r,[{key:"_setPromises",value:function(){this._showDeffered=l.defer(),this._hidingDeffered=l.defer(),this._hiddenDeffered=l.defer()}},{key:"_secureTemplateUrl",value:function(e){return f.trustAsResourceUrl(e)}},{key:"_getTemplate",value:function(){var e=l.defer();if(this.conf.template)e.resolve(this.conf.template);else if(this.conf.templateUrl){var t=this._secureTemplateUrl(this.conf.templateUrl);a(t,!0).then(function(t){return e.resolve(t)})["catch"](function(t){return e.reject(t)})}else if(this.conf.templateHost&&this.conf.templateFile){var n=this._secureTemplateUrl(this.conf.templateHost+this.conf.templateFile);a(n,!0).then(function(t){return e.resolve(t)})["catch"](function(t){return e.reject(t)})}else e.reject(new Error("Please provide template or templateUrl for modal."));return e.promise}},{key:"_getScope",value:function(){return this.conf.scope||(this.conf.scope=t.$new(),this.conf.scope.__hide__=this.conf.bgClose?angular.noop:this._hide.bind(this),this.conf.scope.__bg_hide__=this.conf.bgClose?this._hide.bind(this):angular.noop,this.conf.scope.transitionDuration=this.conf.transitionDuration,this.conf.scope.modalWidth=this.conf.modalWidth,this.conf.scope.backdrop=this.conf.backdrop),this.conf.scope}},{key:"_removeScope",value:function(){this._getScope().$destroy(),delete this.conf.scope}},{key:"_getController",value:function(){if(!this.conf.controller)throw new Error("Failed to retrieve controller for the modal.");return this.conf.controller}},{key:"_setInjectable",value:function(e){this.conf._injectables=e}},{key:"_getInjectables",value:function(){return this.conf._injectables}},{key:"_bindCtrlToScope",value:function(){this._setInjectable(angular.extend({$scope:this._getScope(),$element:this.conf.$element,hide:this._hide.bind(this)},this.conf.inject)),s(this._getController(),this._getInjectables())}},{key:"_compileTemplate",value:function(){var e=this;return this._getTemplate().then(function(t){var n='\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass="nfm-container"\n\t\t\t\t\t\t\tng-style="{\n\t\t\t\t\t\t\t\t\'transition-duration\' : transitionDuration,\n\t\t\t\t\t\t\t\t\'background-color\' : backdrop\n\t\t\t\t\t\t\t}"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class="nfm-close" ng-click="__hide__()"></div>\n\t\t\t\t\t\t\t<div class="nfm-modal" click-outside="__bg_hide__()" ng-style="{\'width\' : modalWidth}">\n\t\t\t\t\t\t\t\t'+t+"\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t";e.conf.$element=i(n)(e._getScope()),e._bindCtrlToScope()},function(e){console.warn("Failed to load template for modal.")})}},{key:"_appendTemplate",value:function(){var e=this;return this._compileTemplate().then(function(){var t=angular.element(o[0].body),i=e.conf.$element,s=t.children();return s.length>0?n.enter(i,t,s[s.length-1]):n.enter(i,t)})}},{key:"_registerListeners",value:function(){var e=this;this._degRegLocCngListnr=t.$on("$locationChangeSuccess",this._hide.bind(this)),o.on("keyup",function(t){e.conf.escClose&&t.which==h.esc&&e._hide()})}},{key:"_deregisterListeners",value:function(){this._degRegLocCngListnr(),o.off("keyup")}},{key:"_show",value:function(){var e=this;this._appendTemplate().then(function(){return e._registerListeners(),e._stateOpen=!0,e.conf.bodyClass&&angular.element(o[0].body).addClass(e.conf.bodyClass),e._showDeffered.resolve({hiding:e._hidingDeffered.promise,hidden:e._hiddenDeffered.promise,element:e.conf.$element})})}},{key:"_hide",value:function(e,t){var n=this;this._deregisterListeners(),c(function(){n._cleanModal(e)},t||this.conf.closeDelay)}},{key:"_cleanModal",value:function(e){var t=this;this._hidingDeffered.resolve(e),n.leave(this.conf.$element).then(function(){t._removeScope(),t._stateOpen=!1,t._hiddenDeffered.resolve(e),t.conf.bodyClass&&angular.element(o[0].body).removeClass(t.conf.bodyClass)})}},{key:"show",value:function(){return this._setPromises(),0==this._stateOpen&&this._show(),this._showDeffered.promise}}]),r}();return u}]);
//# sourceMappingURL=ng-full-modal.min.js.map
